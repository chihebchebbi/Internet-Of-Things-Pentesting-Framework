#!/bin/bash
# HEATHEN IoT pentesting  Framework 
# Developed By Chiheb CHEBBI

clear
#colors
RED='\033[0;31m' 
GREEN='\033[1;32m'
NC='\033[0m' # No Color
BLUE='\033[1;34m'
#Banner


echo -e ${BLUE}
(cat <<-END
         _     _ _______ _______ _______ _     _ _______ __   _
         |_____| |______ |_____|    |    |_____| |______ | \  |
         |     | |______ |     |    |    |     | |______ |  \_|
                                                       
           Internet Of Things Penetration testing Framework
                  Developed by :  Chiheb Chebbi  
      Credits to: Craig Smith-Daniel Miessler-Justin Klein Keane
                      Yunsoul-iiSeymour
                                                       
END
)
#Main Menu
echo -e  "       ------------------------------------------------" ${NC}

echo "        [1]  Insecure Web Interface"
echo "        [2]  Insufficient Authentication/Authorization"
echo "        [3]  Insecure Network Services"
echo "        [4]  Lack of Transport Encryption"
echo "        [5]  Privacy Concerns"
echo "        [6]  Insecure Cloud Interface"
echo "        [7]  Insecure Mobile Interface"
echo "        [8]  Insufficient Security Configurability"
echo "        [9]  Insecure Software/Firmware"
echo "        [10] Poor Physical Security"
echo "        [11] Exit"

echo "        ------------------------------------------------"


read CHOISE

if test $CHOISE == '1'
			then
			echo " Web Interfaces Scanning"
			read -p ' Set Target Host: ' HOST
            nikto -host $HOST


		elif test $CHOISE == '2'
 			then
 						echo -e ${GREEN}
(cat <<-END

	                 --------Insufficient Authentication/Authorization----------

[-] Ensure that any access requiring authentication requires strong passwords
[-] Ensure that user roles can be properly segregated in multi-user environments
[-] Implement two-factor authentication where possible
[-] Ensure password recovery mechanisms are secure
[-] Ensure that users have the option to require strong passwords
[-] Ensure that users have the option to force password expiration after a specific period
[-] Ensure that users have the option to change the default username and password

                                                       
END
)
			
		elif test $CHOISE == '3'
			then
			# get active network interface automatically;
			ACTIVE_INTERFACE="$(ifconfig -a | sed 's/[ \t].*//;/^\(lo\|\)$/d')" 
			
			for active_network_interface in $ACTIVE_INTERFACE
			do
				airmon-ng start ${active_network_interface}

				sudo iw ${active_network_interface} scan | awk -f wifi.awk 

				upnp-inspector 
			done

		elif test $CHOISE == '4'
			then
			
             read -p ' Set Target Host: ' HOST
          
             ~/testssl.sh/testssl.sh $HOST  

		elif test $CHOISE == '5'
			then
			
			echo -e ${GREEN} "Development in progress ..."

		elif test $CHOISE == '6'
			then
			
			echo -e ${GREEN} "Development in progress ..."

		elif test $CHOISE == '7'
			then
			echo -e ${GREEN} "Development in progress ..."

        elif test $CHOISE == '8'
			then
			
			echo -e ${GREEN} "Development in progress ..."


		elif test $CHOISE == '9'
			then
			#frameware Analysis 

			echo -e ${RED}"To learn how to Analyze a .bin file visit: https://www.owasp.org/index.php/IoT_Firmware_Analysis" ${NC}
			read -p ' Enter a BIN File to Analyze: ' BIN
			binwalk $BIN

		elif test $CHOISE == '10'
			then
			echo -e ${BLUE}
(cat <<-END

	                 --------Poor Physical Security----------

 [-] Ensure the device is produced with a minimal number of physical external ports (e.g. USB ports)
 [-] Ensure the firmware of Operating System can not be accessed via unintended methods such as through an unnecessary USB port
 [-] Ensure the product is tamper resistant
 [-] Ensure the product has the ability to limit administrative capabilities in some fashion, possibly by only connecting locally for admin functions 
 [-] Ensure the product has the ability to disable external ports such as USB
                                                       
END
)

		elif test $CHOISE == '11'
			then
			clear
			exit
fi		









